generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

type EntityMetadata {
  name        String
  description String
  discord     String?
  logo        String?
  telegram    String?
  website     String?
  x           String?
}

type AvsOperator {
  address  String
  isActive Boolean
}

model Avs {
  id              String          @id @default(auto()) @map("_id") @db.ObjectId
  address         String          @unique
  metadata        EntityMetadata
  curatedMetadata EntityMetadata?
  tags            String[]

  isVisible  Boolean       @default(false)
  isVerified Boolean       @default(false)
  operators  AvsOperator[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tags], map: "tags_1")
}

model Operator {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  address String @unique

  metadata        EntityMetadata
  curatedMetadata EntityMetadata?
  stakers         String[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Pod {
  id          String @id @default(auto()) @map("_id") @db.ObjectId
  address     String @unique
  owner       String
  blockNumber BigInt

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Deposit {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  address String @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Records all sync tasks
model SyncTask {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  type      String
  status    String
  fromBlock BigInt
  toBlock   BigInt
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

// Collection to store system settings
model Settings {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  key       String   @unique
  value     Json     @db.Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ======================================

model strategies {
  id String @id @default(auto()) @map("_id") @db.ObjectId
}
